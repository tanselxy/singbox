#!/bin/bash

# =============================================================================
# Sing-Box 默认配置文件
# 统一管理硬编码值和默认配置
# =============================================================================

# 端口配置
readonly DEFAULT_DOWNLOAD_PORT=14567
readonly DEFAULT_SS_PORT=443
readonly DEFAULT_VLESS_PORT_MIN=20000
readonly DEFAULT_VLESS_PORT_MAX=20010
readonly DEFAULT_HYSTERIA_PORT_MIN=50000
readonly DEFAULT_HYSTERIA_PORT_MAX=50010
readonly DEFAULT_SS_PORT_MIN=31000
readonly DEFAULT_SS_PORT_MAX=31010

# 固定端口
readonly TROJAN_PORT=63333
readonly TUIC_PORT=61555
readonly SS_DIRECT_PORT=59000
readonly VLESS_CDN_PORT=4433

# 网络配置
readonly NETWORK_TIMEOUT=10
readonly DOWNLOAD_TIMEOUT=300
readonly MAX_RETRIES=3
readonly RETRY_DELAY=2

# 密码和安全配置
readonly DEFAULT_PASSWORD_LENGTH=15
readonly UUID_REGEX="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$"

# 文件路径
readonly LOG_ROTATE_SIZE="10M"
readonly LOG_MAX_FILES=5
readonly TEMP_FILE_TTL=600  # 10分钟

# 域名配置
declare -A DOMAIN_BY_COUNTRY=(
    ["TW"]="www.apple.com"
    ["NG"]="unn.edu.ng" 
    ["JP"]="www.tms-e.co.jp"
    ["US"]="www.thewaltdisneycompany.com"
    ["NL"]="nl.servutech.com"
    ["DE"]="www.mediamarkt.de"
    ["HK"]="www.apple.com"
    ["DEFAULT"]="www.apple.com"
)

# 下载源配置
readonly GITHUB_RELEASES_API="https://api.github.com/repos/SagerNet/sing-box/releases/latest"
readonly GITHUB_PROXY="https://ghproxy.com/"
readonly FALLBACK_VERSION="v1.8.0"

# 系统源配置
readonly UBUNTU_SOURCES="http://archive.ubuntu.com/ubuntu"
readonly DEBIAN_SOURCES="http://deb.debian.org/debian"
readonly SECURITY_SOURCES="http://security.debian.org/debian-security"

# 网络检测
readonly IPV4_CHECK_URLS=(
    "https://api64.ipify.org"
    "https://ifconfig.me"
    "https://ipinfo.io/ip"
)

readonly IPV6_CHECK_URLS=(
    "https://ifconfig.me"
    "https://ipinfo.io/ip"
)

# HTTP服务器配置
readonly HTTP_BIND_IP="0.0.0.0"  # 绑定所有接口，允许外部访问
readonly HTTP_MAX_CONNECTIONS=10

# 证书配置
readonly CERT_VALIDITY_DAYS=36500
readonly CERT_CN="bing.com"
readonly DEFAULT_CERT_PERMS=600
readonly DEFAULT_KEY_PERMS=600

# Reality配置
readonly REALITY_PUBLIC_KEY="Y_-yCHC3Qi-Kz6OWpueQckAJSQuGEKffwWp8MlFgwTs"
readonly REALITY_SHORT_ID="0123456789abcded"

# 日志级别
readonly LOG_LEVEL_ERROR=1
readonly LOG_LEVEL_WARN=2
readonly LOG_LEVEL_INFO=3
readonly LOG_LEVEL_DEBUG=4

# 当前日志级别 (可通过环境变量 SINGBOX_LOG_LEVEL 覆盖)
CURRENT_LOG_LEVEL=${SINGBOX_LOG_LEVEL:-$LOG_LEVEL_INFO}